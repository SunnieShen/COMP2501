estimate_pi <- function(n_iter, seed=42){
set.seed(seed)
x <- runif(n_iter, min=0, max=1) - 0.5
y <- runif(n_iter, min=0, max=1) - 0.5
dist <- sqrt(x**2 + y**2)
area <- mean(dist <= 0.5)
pi <- 4 * area
pi
}
n_iters <- c(1e1, 1e2, 1e3, 1e4, 1e5)
seeds <- seq(1:100)
df <- expand.grid(n_iters, seeds) |> setNames(c("n_iter", "seed"))
df$pi_estimates <- mapply(estimate_pi, df$n_iter, df$seed)
View(df)
df |>
group_by(n_iter) |>
summarize(mean=mean(pi_estimates), sd=sd(pi_estimates)) |>
mutate(mean=format(mean, digits=5))
library(tidyverse)
library(dslabs)
library(gtools)
install.packages("gtools")
> library(gtools)
library(gtools)
df |>
group_by(n_iter) |>
summarize(mean=mean(pi_estimates), sd=sd(pi_estimates)) |>
mutate(mean=format(mean, digits=5))
df |>
ggplot(aes(x = n_iter, y = pi_estimates, group = n_iter)) +
geom_hline(yintercept = pi, linetype = "dashed") +
geom_boxplot() +
scale_x_log10() +
theme_minimal()
bead <- rep(c("red","blue"), times = c(2,3))
bead
sample(bead, 1)
sample(bead, 1)
mean(replicate(1e5, sample(bead, 1) =="blue"))
mean(replicate(1e8, sample(bead, 1) =="blue"))
mean(replicate(1e6, sample(bead, 1) =="blue"))
mean(replicate(1e8, sample(bead, 1) =="blue"))
three_card_combinations <- permutations(52, 3, v=deck)
# Simulations for pokers
suits <- c("Diamonds", "Clubs", "Hearts", "Spades")
numbers <- c(
"Ace", "Deuce", "Three", "Four", "Five", "Six", "Seven",
"Eight", "Nine", "Ten", "Jack", "Queen", "King")
deck <- expand.grid(number=numbers, suit=suits)
deck <- paste(deck$number, deck$suit)
sample(deck, 5, replace=FALSE)
# Three-card scenarios
three_card_combinations <- permutations(52, 3, v=deck)
heart_cards <- paste(numbers, "Hearts")
p_first_is_heart <- mean(three_card_combinations[,1] %in% heart_cards)
p_second_is_heart <- mean(three_card_combinations[,2] %in% heart_cards)
p_third_is_heart <- mean(three_card_combinations[,3] %in% heart_cards)
p_all_are_heart <- mean(
three_card_combinations[,1] %in% heart_cards &
three_card_combinations[,2] %in% heart_cards &
three_card_combinations[,3] %in% heart_cards)
print(p_first_is_heart * p_second_is_heart * p_third_is_heart)
print(p_all_are_heart)
?sample()
View(three_card_combinations)
?combinations()
# 生日悖论可视化
library(ggplot2)
birthday_analysis <- function(max_size = 60) {
sizes <- 1:max_size
probabilities <- sapply(sizes, birthday_paradox_theoretical)
df <- data.frame(
group_size = sizes,
probability = probabilities
)
ggplot(df, aes(x = group_size, y = probability)) +
geom_line(color = "blue", size = 1) +
geom_point(data = df[df$group_size == 23, ], color = "red", size = 3) +
geom_point(data = df[df$group_size == 50, ], color = "darkred", size = 3) +
geom_hline(yintercept = 0.5, linetype = "dashed", color = "gray") +
geom_hline(yintercept = 0.96, linetype = "dashed", color = "gray") +
annotate("text", x = 23, y = 0.55, label = "23人: >50%", color = "red") +
annotate("text", x = 50, y = 0.85, label = "50人: >96%", color = "darkred") +
labs(title = "生日悖论",
x = "群体人数",
y = "至少两人同一天生日的概率") +
theme_minimal()
}
# 生成图表
birthday_analysis(60)
# 蒙提霍尔问题模拟
simplified_monty_hall <- function(n = 10000) {
# 随机生成汽车位置和初始选择
cars <- sample(1:3, n, replace = TRUE)
initial_choices <- sample(1:3, n, replace = TRUE)
# 换门策略：总是换到另一扇未开的门
switch_wins <- mean(initial_choices != cars)  # 初始选错时换门就赢
# 不换门策略：坚持初始选择
stay_wins <- mean(initial_choices == cars)    # 初始选对时就赢
return(list(switch = switch_wins, stay = stay_wins))
}
results <- simplified_monty_hall(10000)
cat("换门胜率:", results$switch, "不换门胜率:", results$stay, "\n")
# 加载必要的库
library(dplyr)
library(readr)
library(tidyr)
# 读取数据
data <- read_csv("https://storage.googleapis.com/kagglesdsdata/datasets/8437704/13310787/student_exam_scores.csv")
library(tidyverse)
library(dslabs)
library(gtools)
library(ggridges)
data <- read_csv("https://storage.googleapis.com/kagglesdsdata/datasets/8437704/13310787/student_exam_scores.csv")
library(readr)
# 加载必要的库
library(dplyr)
library(readr)
library(tidyr)
# 读取数据
data <- read_csv("https://storage.googleapis.com/kagglesdsdata/datasets/8437704/13310787/student_exam_scores.csv")
library(tidyverse)
library(tidyverse)
library(dslabs)
library(gtools)
library(ggridges)
?pnnorm()
library(tidyverse)
library(dslabs)
library(gtools)
library(ggridges)
?pnorm()
